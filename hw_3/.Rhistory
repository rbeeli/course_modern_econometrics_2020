col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+6, 0.5, labels=bquote(t[0]^"*"==~.(MSEs.min)), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'red', 'blue', 'green', 'cyan', 'purple')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+10, 0.5, labels=bquote(t[0]^"*"==~.(MSEs.min)), cex=1.1)
text(MSEs.min+10, 0.5, labels=bquote(t[0]^"*"==~.(MSEs.min)==.(stocks$Dates[MSEs.min])), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'red', 'blue', 'green', 'cyan', 'purple')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+10, 0.5, labels=bquote(t[0]^"*"==~.(MSEs.min)==.(stocks$Dates[MSEs.min])), cex=1.1)
stocks$Dates[MSEs.min]
stocks$Date[MSEs.min]
text(MSEs.min+10, 0.5, labels=bquote(t[0]^"*"==~.(MSEs.min)==.(stocks$Date[MSEs.min])), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'red', 'blue', 'green', 'cyan', 'purple')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+10, 0.5, labels=bquote(t[0]^"*"==~.(MSEs.min)==.(stocks$Date[MSEs.min])), cex=1.1)
MSEs.min.date = strftime(stocks$Date[MSEs.min], '%Y-%m-%d')
MSEs.min.date = strftime(stocks$Date[MSEs.min], '%d.%m.%Y')
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'red', 'blue', 'green', 'cyan', 'purple')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+10, 0.5, labels=bquote(t[0]^"*"==~.(MSEs.min)==.(MSEs.min.date)), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'red', 'blue', 'green', 'cyan', 'purple')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+10, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
text(MSEs.min+20, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'red', 'blue', 'green', 'cyan', 'purple')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+20, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'red', 'blue', 'green', 'cyan', 'purple')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'darkgoldenrod', 'cadetblue3', 'burlywood3', 'darkorchid4', 'goldenrod3')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'darkgoldenrod', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink4')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('red', 'blue', 'green', 'cyan', 'purple',
'darkgoldenrod', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('deepskyblue', 'blue', 'green', 'cyan', 'purple',
'darkgoldenrod', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('deepskyblue', 'blue', 'green', 'cyan', 'red',
'darkgoldenrod', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('deepskyblue', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
View(stocks)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
View(stocks)
View(stocks)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
View(cumrets)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
colnames(cumrets)[1] = 'Market'
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
lines(market$Mkt, type='l')
lines(market$Mkt, type='l')
lines(market$Mkt, type='l')
lines(market$Mkt, type='l')
lines(market$Mkt, type='l')
lines(market$Mkt, type='l')
lines(market$Mkt, type='l', lwd=2, lty=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
lines(market$Mkt, type='l', lwd=2, lty=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), market$Mkt, type='l', xlim=c(0, 170), lwd=2, lty=2)
lines(1:nrow(cumrets), market$Mkt, type='l', xlim=c(0, 170))
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=1, xlim=c(0, 170), col=cols,
main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), market$Mkt, type='l', xlim=c(0, 170))
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=1, xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170))
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2, lty=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=1, xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2, lty=2)
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2, lty=5)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=1, xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2, lty=5)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=2, xlim=c(0, 170),
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=rep(2, 10), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=rep(3, 10), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=rep(4, 10), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=rep(5, 10), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=rep(6, 10), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(stocks[,-1])
matplot(1:nrow(cumrets), cumrets, type='l', lty=rep(6, 10), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
cols = c('black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
c(1, rep(6, 10))
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
#lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1
# plot stock and market returns and t_0 which minimizes average MSE
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
colnames(cumrets)[1] = 'Market'
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
#lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
# plot stock and market returns and t_0 which minimizes average MSE
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
colnames(cumrets)[1] = 'Market'
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
#lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
# plot stock and market returns and t_0 which minimizes average MSE
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
colnames(cumrets)[1] = 'Market'
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
#lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
# plot stock and market returns and t_0 which minimizes average MSE
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
colnames(cumrets)[1] = 'Market'
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', ylab='Cumulative returns')
#lines(1:nrow(cumrets), 1 + cumsum(market$Mkt), type='l', xlim=c(0, 170), lwd=2)
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
# plot stock and market returns and t_0 which minimizes average MSE
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
colnames(cumrets)[1] = 'Market'
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', xlab='Date index', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
t_0 = which(market$Date == '2001-02-01')
# indicator variables
ind_1 = as.integer(1:N < t_0)
ind_2 = as.integer(1:N >= t_0)
for (i in 1:K) {
rets.ex = stocks[,i+1] - market$Rf
mkt.ex = market$Mkt.ex
segment1 = ind_1*mkt.ex
segment2 = ind_2*mkt.ex
# no intercept!
fit = lm(rets.ex ~ -1 + segment1 + segment2)
fit_sum = summary(fit)
print(fit_sum)
# test hypothesis beta_1 = beta_2
test_eq = linearHypothesis(fit, 'segment1 = segment2')
cat(sprintf('%02.0f   H_0: beta_1 = beta_2, p-value=%.4f\n', i, test_eq[2, 'Pr(>F)']))
}
t_0 = which(market$Date == '2001-02-01')
# indicator variables
ind_1 = as.integer(1:N < t_0)
ind_2 = as.integer(1:N >= t_0)
for (i in 1:K) {
rets.ex = stocks[,i+1] - market$Rf
mkt.ex = market$Mkt.ex
segment1 = ind_1*mkt.ex
segment2 = ind_2*mkt.ex
# no intercept!
fit = lm(rets.ex ~ -1 + segment1 + segment2)
fit_sum = summary(fit)
print(fit_sum)
# test hypothesis beta_1 = beta_2
test_eq = linearHypothesis(fit, 'segment1 = segment2')
cat(sprintf('%02.0f   H_0: beta_1 = beta_2, p-value=%.4f\n', i, test_eq[2, 'Pr(>F)']))
}
View(stocks)
View(stocks)
# plot stock and market returns and t_0 which minimizes average MSE
cols = c('black', 'black', 'blue', 'green', 'cyan', 'red',
'chartreuse', 'cadetblue3', 'burlywood3', 'darkorchid4', 'deeppink')
cumrets = 1 + cumsum(cbind(market$Mkt, stocks[,-1]))
colnames(cumrets)[1] = 'Market'
matplot(1:nrow(cumrets), cumrets, type='l',
lty=c(1, rep(6, 10)), lwd=c(2, rep(1, 10)), xlim=c(0, 170),
col=cols, main='Stock returns', xlab='Date index', ylab='Cumulative returns')
abline(v=MSEs.min, col='red', lwd=3)
text(nrow(cumrets) + 15, cumrets[nrow(cumrets),][seq(2, 10, 2)],
labels=colnames(cumrets)[seq(2, 10, 2)], cex=0.7,
col=cols[seq(2, 10, 2)])
text(nrow(cumrets) + 5, cumrets[nrow(cumrets),][seq(1, 10, 2)],
labels=colnames(cumrets)[seq(1, 10, 2)], cex=0.7,
col=cols[seq(1, 10, 2)])
text(MSEs.min+18, 0.5, labels=bquote(t[0]^"*"==.(MSEs.min.date)), cex=1.1)
source('/mnt/9df5388e-fbdd-424c-a6b2-6b28c3989433/repo/course_modern_econometrics_2020/hw_3/exercise_2.R', echo=TRUE)
